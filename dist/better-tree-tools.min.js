function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&module.exports?module.exports=e():(t="undefined"!=typeof globalThis?globalThis:t).BetterTreeTools=e()}(this,function(){function t(t){this.config=Object.assign({id:"id",pId:"pId",children:"children"},t)}return t.prototype={typeIs:function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},listToTree:function(t){var e=this.config,r=e.id,i=e.pId,n=e.children,o=[];if("array"!==this.typeIs(t))return o;t.forEach(function(t){delete t[n]});var s={};return t.forEach(function(t){s[t[r]]=t}),t.forEach(function(t){var e=s[t[i]];(e?e[n]||(e[n]=[]):o).push(t)}),o},listFastToTree:function(t){var e=this.config,r=e.id,i=e.pId,n=e.children,o=[],s={},f=!0,u=!1,h=void 0;try{for(var d=t[Symbol.iterator]();!(f=(a=d.next()).done);f=!0){var c=a.value,l=c[r],a=c[i];s[l]||(s[l]=_defineProperty({},n,[])),s[l]=Object.assign(c,_defineProperty({},n,s[l][n])),a&&"0"!=a?(s[a]||(s[a]=_defineProperty({},n,[])),s[a][n].push(s[l])):o.push(s[l])}}catch(t){u=!0,h=t}finally{try{!f&&d.return&&d.return()}finally{if(u)throw h}}return o},treeToList:function(t){var s=this,f=[],u=this.config.children;return function t(e){if("array"!==s.typeIs(e))f.push(e);else for(var r=0,i=e.length;r<i;r++){var n=e[r],o=JSON.parse(JSON.stringify(n[u]||"[]"));"array"===s.typeIs(n[u])?(delete n[u],f.push(n),t(o)):f.push(n)}}(t),f},getNode:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],i=e,n=this.config.id,o=this.treeToList(r),s=0,f=o.length;s<f;s++){var u=o[s];if(u[n]===i)return u}return null},getNodeList:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],i=1<arguments.length&&void 0!==e?e:{},n=this.config,o=n.id,s=n.pId,f=i[o],u=i[s],h=[],d=this.treeToList(r),c=0,l=d.length;c<l;c++){var a=d[c];a[o]!==f&&a[s]!==u||h.push(a)}return h},removeNode:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],i=1<arguments.length&&void 0!==e?e:{},n=this.config,o=n.id,s=n.pId,f=i[o],u=i[s],h=this.treeToList(r),d=0,c=h.length;d<c;d++){var l=h[d];l&&(l[o]!==f&&l[s]!==u||(delete h[d],--d))}return this.listToTree(h)},insert:function(t,e,r){for(var i=this.treeToList(t),n=0,o=i.length;n<o;n++)i[n].sort=n;r=this.getNode(i,r);r&&(e.pId=r.id,e.sort=r.sort-1),i.push(e);e=this.listToTree(i);return this.sort(e)},sort:function(t){var r=this,i=this.config.children;return function e(t){t=t.sort(function(t,e){return t.sort-e.sort});t.length&&t.forEach(function(t){"array"===r.typeIs(t[i])&&e(t[i])})}(t),t}},t});