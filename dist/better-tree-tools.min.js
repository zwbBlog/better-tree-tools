var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,r=Array(t.length);e<t.length;e++)r[e]=t[e];return r}return Array.from(t)}!function(t,e){"function"==typeof define&&define.amd?define(e):"undefined"!=typeof module&&module.exports?module.exports=e():(t="undefined"!=typeof globalThis?globalThis:t).BetterTreeTools=e()}(this,function(){function t(t){this.config=Object.assign({id:"id",pId:"pId",children:"children"},t)}return t.prototype={typeIs:function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},deepCopy:function(t){var r=this,n="array"===this.typeIs(t)?[]:{},o=["array","object"];if(!o.includes(this.typeIs(t)))return t;return function(t){for(var e in t)t.hasOwnProperty(e)&&("object"===_typeof(t[e])&&o.includes(r.typeIs(t[e]))?n[e]=r.deepCopy(t[e]):n[e]=t[e])}(t),n},listToTree:function(t){var e=this.config,r=e.id,n=e.pId,o=e.children,i=[];if("array"!==this.typeIs(t))return i;t.forEach(function(t){delete t[o]});var s={};return t.forEach(function(t){s[t[r]]=t}),t.forEach(function(t){var e=s[t[n]];(e?e[o]||(e[o]=[]):i).push(t)}),i},treeToList:function(t){function s(e){0===r.filter(function(t){return t[n]===e[n]}).length&&r.push(e)}var f=this,r=[],e=this.config,u=e.children,n=e.id,t=this.deepCopy(t);return function t(e){if("array"!==f.typeIs(e))s(e);else for(var r=0,n=e.length;r<n;r++){var o,i=e[r];i[u]&&"array"===f.typeIs(i[u])?(o=f.deepCopy(i[u]),delete i[u],s(i),t(o)):s(i)}}(t),r},getNode:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],n=e,r=this.deepCopy(r),o=this.config.id,i=this.treeToList(r),s=0,f=i.length;s<f;s++){var u=i[s];if(u[o]===n)return u}return null},getNodeList:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],n=1<arguments.length&&void 0!==e?e:{},o=this.deepCopy(r),r=this.config,i=r.id,s=r.pId,f=n[i],u=n[s],c=[],h=this.treeToList(o),l=0,a=h.length;l<a;l++){var p=h[l];p[i]!==f&&p[s]!==u||c.push(p)}return c},removeNode:function(t,e){for(var r=0<arguments.length&&void 0!==t?t:[],n=1<arguments.length&&void 0!==e?e:{},o=this.config,i=o.id,s=o.pId,f=n[i],u=n[s],c=this.treeToList(r),h=0,l=c.length;h<l;h++){var a=c[h];a&&(a[i]!==f&&a[s]!==u||(delete c[h],--h))}return this.listToTree(c)},insert:function(t,e){t=this.treeToList(t);return t.push.apply(t,_toConsumableArray(e)),this.listToTree(t)},sort:function(t){var r=this,n=this.config.children;return function e(t){t=t.sort(function(t,e){return t.sort-e.sort});t.length&&t.forEach(function(t){"array"===r.typeIs(t[n])&&e(t[n])})}(t),t}},t});