function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&module.exports?module.exports=t():(e="undefined"!=typeof globalThis?globalThis:e).BetterTreeTools=t()}(this,function(){function e(e){this.config=Object.assign({id:"id",pId:"pId",children:"children"},e)}return e.prototype={typeIs:function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},listToTree:function(e){var t=this.config,r=t.id,n=t.pId,i=t.children,o=[];if("array"!==this.typeIs(e))return o;e.forEach(function(e){delete e[i]});var s={};return e.forEach(function(e){s[e[r]]=e}),e.forEach(function(e){var t=s[e[n]];(t?t[i]||(t[i]=[]):o).push(e)}),o},listFastToTree:function(e){var t=this.config,r=t.id,n=t.pId,i=t.children,o=[],s={},f=!0,u=!1,d=void 0;try{for(var h=e[Symbol.iterator]();!(f=(l=h.next()).done);f=!0){var a=l.value,c=a[r],l=a[n];s[c]||(s[c]=_defineProperty({},i,[])),s[c]=Object.assign(a,_defineProperty({},i,s[c][i])),l&&"0"!=l?(s[l]||(s[l]=_defineProperty({},i,[])),s[l][i].push(s[c])):o.push(s[c])}}catch(e){u=!0,d=e}finally{try{!f&&h.return&&h.return()}finally{if(u)throw d}}return o},treeToList:function(e){var s=this,f=[],u=this.config.children;return function e(t){if("array"!==s.typeIs(t))f.push(t);else for(var r=0,n=t.length;r<n;r++){var i=t[r],o=JSON.parse(JSON.stringify(i[u]||"[]"));"array"===s.typeIs(i[u])?(delete i[u],f.push(i),e(o)):f.push(i)}}(e),f},getNode:function(e,t){var o=this,r=0<arguments.length&&void 0!==e?e:[],s=t,n=this.config,f=n.id,u=n.children;return function e(t){for(var r=0,n=t.length;r<n;r++){var i=t[r];if(i[f]===s)return i;"array"===o.typeIs(i[u])&&(delete i[u],e(i[u]))}}(r)},getNodeList:function(e,t){var s=this,r=0<arguments.length&&void 0!==e?e:[],n=1<arguments.length&&void 0!==t?t:{},i=this.config,f=i.id,u=i.pId,d=i.children,h=n[f],a=n[u],c=[];return function e(t){for(var r=0,n=t.length;r<n;r++){var i,o=t[r];o[f]!==h&&o[u]!==a||c.push(o),"array"===s.typeIs(o[d])&&(i=JSON.parse(JSON.stringify(o[d])),delete o[d],e(i))}}(r),c},removeNode:function(e,t){for(var r=0<arguments.length&&void 0!==e?e:[],n=1<arguments.length&&void 0!==t?t:{},i=this.config,o=i.id,s=i.pId,f=n[o],u=n[s],d=this.treeToList(r),h=0,a=d.length;h<a;h++){var c=d[h];c&&(c[o]!==f&&c[s]!==u||(delete d[h],--h))}return this.listToTree(d)},insert:function(e,t,r){for(var n=this.treeToList(e),i=0,o=n.length;i<o;i++)n[i].sort=i;r=this.getNode(n,r);r&&(t.pId=r.id,t.sort=r.sort-1),n.push(t);t=this.listToTree(n);return this.sort(t)},sort:function(e){var r=this,n=this.config.children;return function t(e){e=e.sort(function(e,t){return e.sort-t.sort});e.length&&e.forEach(function(e){"array"===r.typeIs(e[n])&&t(e[n])})}(e),e}},e});